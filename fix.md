# 新稿修复映射（基于 question.md）

逐条对照审稿问题，标注新稿是否已修复，并给出 paper_new.tex 的证据位置与简要说明。

## Referee 1

- R1-1 重写 Section 6.2，纳入近期综述；补充非以太坊链讨论
  - 状态：部分修复
  - 证据：多链与泛化
    - `paper_new.tex:281` “on Ethereum and Polygon” 明确为多链；`paper_new.tex:356-357`、`paper_new.tex:637` 给出 4.345 亿字节码规模与两链数据来源；`paper_new.tex:1601-1616` External Validity 讨论多链与可扩展性。
  - 证据：相关工作扩展
    - `paper_new.tex:1619-1640`、`paper_new.tex:1642-1671` 扩展了相关工作版块与若干新引用。
  - 待改进：未检索到审稿人建议的 Computing Surveys 综述引用（如 10.1145/3593293）；建议在 Related Work 中补充该类综述并在讨论中呼应其结论。

## Referee 2

- R2-1 数据集仅 <1% verified，结论外推风险
  - 状态：已修复
  - 证据：改为字节码级、全量扫描并跨链
    - `paper_new.tex:356-357`、`paper_new.tex:637` 说明从 BigQuery 抽取 434,542,165 合约字节码（两链），
      `paper_new.tex:640-670` 描述字节码级工厂检测与可达性分析避免假阳性，
      `paper_new.tex:720-766` 给出 RQ1 指标（FPR 0.17%、FNR 8.39%）及执行效率。

- R2-2 四个安全检测器的泛化与字节码支持；技术挑战与可行性
  - 状态：部分修复
  - 证据：检测器层面提供了字节码级“工厂检测器”的完整设计与评测（覆盖后续分析基础）
    - `paper_new.tex:640-670`（算法思路）、`paper_new.tex:720-766`（评测与误差分析）。
  - 说明：新稿将安全部分重构为“攻击向量 + 安全问题”的系统化分析（RQ5），未再声称基于源代码的四类“安全检测器”与其数量性发现。因此对“安全检测器字节码化与评测”的审稿意见已通过研究范围与方法论调整间接回应，但未提供针对每个安全问题的检测器与定量评测。

- R2-3 聚类仅依赖名称，建议引入代码特征
  - 状态：已修复
  - 证据：使用多视图特征（名称 token、结构规模、机制标志、访问控制/库、业务关键词），PCA+KMeans
    - `paper_new.tex:876-890` 特征设计与聚类流程；`paper_new.tex:896-911` 四大域的具体刻画与信号。

- R2-4 除 Tornado 以外缺少具体案例（每类至少一例）
  - 状态：已修复
  - 证据：
    - Mutable Code（Tornado 案例）：`paper_new.tex:1216-1259`。
    - Address Spoofing Attack（新增攻击向量）：`paper_new.tex:1263-1300`。
    - Unhandled Low-Level Contract Creation（真实场景与对策）：`paper_new.tex:1306-1358`、`paper_new.tex:1360-1380`。
    - Unexpected Ownership Transfer（NFT 平台场景）：`paper_new.tex:1414-1447`。
    - Unverified Master Contract（NinfaFactory 示例）：`paper_new.tex:1472-1516`。

- R2-5 升级合约的其他风险（如代理存储冲突）应予以承认/讨论
  - 状态：部分修复
  - 证据：
    - 聚类域“Proxy & Upgrade”明确涉及 EIP-1967 存储槽、UUPS/Beacon 等升级栈：`paper_new.tex:906-907`。
  - 待改进：可在讨论或相关工作中显式点出“存储槽冲突（storage collision）”风险及其与工厂部署的关系，以回应审稿人点名建议。

- R2-6 Mutable Code 误报：权限守卫路径（onlyOwner）如何处理？给出精确率/召回率
  - 状态：未直接修复（语义变更）
  - 说明：新稿未实现“Mutable Code”自动检测器的定量评测，而是将其作为攻击向量阐述并给出检查要点与防御建议（如 SELFDESTRUCT/DELEGATECALL 可达性、extcodehash 校验，见 `paper_new.tex:1239-1259`）。若需完全响应此条，建议在补充材料中给出“变形合约检测”原型与受权限守卫约束的精确率/召回率估计，或在回复信中解释为何不再提供此类检测器的定量评测。

- R2-typo 拼写/标注问题
  - 状态：部分修复
  - 证据：Uniswap 引用已正确指向图表编号：`paper_new.tex:955-962`；
    但“USCHunt focus”主谓一致问题仍在：`paper_new.tex:1656-1657`（应改为 “USCHunt focuses…”）。

## Referee 3

- R3-1 引言两条“研究空白”区分度不足
  - 状态：已修复
  - 证据：摘要明确三项缺口（全景、超越传统代理家族的实现谱系、面向工厂的攻击向量与问题）：
    - `paper_new.tex:270-289`。

- R3-2 需阐明工厂/工厂部署与 EOA 直部署的差异；区分两类对象的安全风险
  - 状态：已修复
  - 证据：部署方法学与对比图：`paper_new.tex:500-535`；
    安全问题处明确“工厂部署合约”的问题归属：`paper_new.tex:1410-1420`（图题即标注 factory-deployed contracts）。

- R3-3 工厂检测技术依赖现有工具、未见创新；未验证合约检测易漏报
  - 状态：已修复
  - 证据：给出字节码级 CFG+可达性分析的工厂检测算法与评测：`paper_new.tex:640-670`、`paper_new.tex:720-766`；并分析代理导致的漏报边界。

- R3-4 1,180 安全问题但缺少检测器设计细节与验证
  - 状态：部分修复（范围调整）
  - 说明：新稿不再声称“1180 个问题”，而以“攻击向量+安全问题+案例+对策”的方式呈现（`paper_new.tex:1196-1532`）。针对“工厂检测器”提供了系统评测；针对各安全问题未提供检测器级别的精确率/召回率与对比。

- R3-5 仅以太坊主网，泛化性受限
  - 状态：已修复
  - 证据：跨链（以太坊+Polygon）并在 Threats to Validity 中阐述外部效度：`paper_new.tex:281`、`paper_new.tex:1601-1616`。

- R3-6 未量化经济影响/严重性；Tornado 之外真实攻击有限
  - 状态：部分修复
  - 证据：为三类安全问题提供了现实案例与影响叙述：`paper_new.tex:1306-1358`、`paper_new.tex:1414-1447`、`paper_new.tex:1472-1516`。
  - 待改进：可补充损失量级/受影响项目数等量化指标，或在讨论中加入更系统的严重性评估框架。

## Referee 4

- R4-1 人工分析依赖较多：审计人员背景、时间成本、冲突解决
  - 状态：部分修复
  - 证据：提供三名审计员、独立评审+投票、专家讨论与审计指南：`paper_new.tex:1573-1590`；公开审计工件：`paper_new.tex:1590-1596`。
  - 待改进：未见“审计人员背景/资历”与“总计投入工时”等量化信息，可在回复信中补充说明。

- R4-2 1180 问题的真实性验证与检测器漏报/误报
  - 状态：已修复（通过范围收敛与检测器评测替代）
  - 说明：新稿不再宣称数量性结论，而在 RQ1 对核心“工厂检测器”进行系统验证（`paper_new.tex:720-766`），并对各安全问题提供具体案例与对策。

- R4-3 缺少严重性评估/现实影响量化
  - 状态：部分修复（同 R3-6）

- R4-4 技术贡献与新颖性有限（规则化检测、依赖现有工具）
  - 状态：已修复
  - 证据：提出并评测字节码级检测基础设施、跨链与全量规模的实证分析、语义化聚类与安全向量体系：`paper_new.tex:356-357`、`paper_new.tex:640-670`、`paper_new.tex:876-911`、`paper_new.tex:1196-1532`。

- R4-5 呈现与可读性（算法-1 范围不清，个别拼写问题）
  - 状态：部分修复
  - 证据：新增 Factory Detector 算法伪码（`paper_new.tex:700-720` 上下）；图表引用一致性改进（如 Uniswap 代码段 `paper_new.tex:955-962`）。
  - 待改进：USCHunt 主谓一致仍需更正（`paper_new.tex:1656-1657`）。若审稿人对其他检测步骤也期望伪码，可在附录统一给出安全问题的检测要点与伪代码框架（即便当前不做规模化评测）。

---

小结与建议
- 新稿在“数据与方法（全量字节码、跨链）、检测基础设施、聚类方法、案例与防御建议、威胁与有效性声明”等关键点上对核心关切做出了实体性改进。
- 仍建议的点：
  - 补充 1–2 篇近期综述引用并在 Related Work 与 Discussion 中呼应（对应 R1）。
  - 在 RQ5 或附录中，增加针对“Mutable Code”等问题的最小可用检测原型与小规模指标，或在回复中解释为何改为“向量+问题+案例+对策”的形式（对应 R2/R3/R4）。
  - 显式讨论“存储槽冲突”风控承接（对应 R2）。
  - 修正 USCHunt 主谓一致与进行一次通读勘误（对应 R2/R4）。

